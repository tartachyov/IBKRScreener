"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var text_utils_1 = require("../_utils/text.utils");
var IBKRConnection_1 = __importDefault(require("../connection/IBKRConnection"));
exports.getContractDetails = function (contract) {
    var contractArg = contract;
    var contractsLocal = [];
    var reqId = text_utils_1.getRadomReqId();
    return new Promise(function (resolve) {
        var ib = IBKRConnection_1.default.Instance.getIBKR();
        // If string, create stock contract as default
        if (typeof contractArg === 'string') {
            contractArg = ib.contract.stock(contractArg);
        }
        var handleContract = function (reqId, contractReceived) {
            contractsLocal.push(contractReceived);
        };
        ib.on('contractDetails', handleContract);
        ib.once('contractDetailsEnd', function (reqIdX) {
            if (reqId === reqIdX) {
                ib.off('contractDetails', handleContract);
                if (typeof contract === 'string') {
                    return resolve(contractsLocal[0]);
                }
                resolve(contractsLocal);
            }
        });
        ib.reqContractDetails(reqId, contractArg);
    });
};
//# sourceMappingURL=ContractDetails.js.map